# 01-04-PLAN: Chain Validation

> **Phase:** 01-contracts-first-governance-core  
> **Plan ID:** 01-04  
> **Status:** PENDING  
> **Created:** 2026-02-03  
> **Owner:** idumb-supreme-coordinator  

---

## Objective

Validate the complete agent and command chain to ensure governance hierarchy is properly enforced. This plan verifies that all contracts from 01-01, 01-02, and 01-03 are correctly implemented and the delegation chain functions end-to-end.

---

## Prerequisites

| Prerequisite | Source | Status |
|--------------|--------|--------|
| Agent contracts defined | 01-01-PLAN.md | ✅ |
| Command contracts defined | 01-02-PLAN.md | ✅ |
| Tool contracts defined | 01-03-PLAN.md | ✅ |

---

## Tasks

<task id="01-04-T1" priority="P1">
### Task 1: Validate Agent Chain

**Objective:** Verify all 10 agents have valid frontmatter and hierarchy permissions match their designated roles.

**Acceptance Criteria:**
- [ ] All 10 agent files exist in `template/agents/`
- [ ] Each agent has valid YAML frontmatter (parseable, no syntax errors)
- [ ] `idumb-supreme-coordinator` has `edit: deny`, `write: deny`, `bash: deny`
- [ ] `idumb-high-governance` has `edit: deny`, `write: deny`
- [ ] `idumb-low-validator` has `edit: deny`, `write: deny`, read-only bash
- [ ] `idumb-builder` has `edit: allow`, `write: allow`
- [ ] Delegation permissions form valid DAG (no cycles)
- [ ] Temperature settings appropriate for role (coordinators: 0.1-0.3)

**Validation Steps:**
1. Parse all `template/agents/idumb-*.md` files
2. Extract and validate YAML frontmatter against schema
3. Cross-reference `permission.task` entries with actual agents
4. Verify hierarchy matches AGENTS.md specification

**Evidence Required:**
```
.idumb/governance/validations/agent-chain-2026-02-03.json
```

**Evidence Schema:**
```json
{
  "validation_type": "agent-chain",
  "timestamp": "ISO-8601",
  "agents_validated": 10,
  "results": [
    {
      "agent": "idumb-supreme-coordinator",
      "frontmatter_valid": true,
      "permissions_correct": true,
      "hierarchy_valid": true,
      "issues": []
    }
  ],
  "overall_status": "PASS|FAIL",
  "blocking_issues": []
}
```

**Estimated Effort:** 30 minutes  
**Delegated To:** idumb-low-validator
</task>

---

<task id="01-04-T2" priority="P1">
### Task 2: Validate Command Chain

**Objective:** Verify all 12 commands have correct agent binding and workflow linkage.

**Acceptance Criteria:**
- [ ] All 12 command files exist in `template/commands/idumb/`
- [ ] Each command has `agent: idumb-supreme-coordinator` in frontmatter
- [ ] All commands have valid `description` field
- [ ] Workflow commands (`init`, `sync`, `roadmap`, etc.) have proper sequencing
- [ ] Help and status commands are read-only (no state modification)
- [ ] Phase execution commands reference valid phase structure

**Validation Steps:**
1. Parse all `template/commands/idumb/*.md` files
2. Extract and validate YAML frontmatter
3. Verify `agent` field points to valid agent
4. Check command dependencies form valid execution graph
5. Validate against chain-enforcement.md rules

**Evidence Required:**
```
.idumb/governance/validations/command-chain-2026-02-03.json
```

**Evidence Schema:**
```json
{
  "validation_type": "command-chain",
  "timestamp": "ISO-8601",
  "commands_validated": 12,
  "results": [
    {
      "command": "init",
      "agent_binding": "idumb-supreme-coordinator",
      "frontmatter_valid": true,
      "workflow_position": "entry",
      "dependencies": [],
      "issues": []
    }
  ],
  "workflow_graph_valid": true,
  "overall_status": "PASS|FAIL",
  "blocking_issues": []
}
```

**Estimated Effort:** 30 minutes  
**Delegated To:** idumb-low-validator
</task>

---

<task id="01-04-T3" priority="P0">
### Task 3: E2E Chain Test

**Objective:** Test the complete delegation chain by simulating `/idumb:plan-phase 1` workflow.

**Acceptance Criteria:**
- [ ] Command invocation reaches idumb-supreme-coordinator
- [ ] Supreme-coordinator delegates to idumb-high-governance
- [ ] High-governance delegates validation to idumb-low-validator
- [ ] Low-validator returns validation results
- [ ] High-governance delegates execution to idumb-builder (if needed)
- [ ] Builder creates artifacts and returns
- [ ] Full chain completes without permission violations
- [ ] State updates propagate correctly through `.idumb/brain/state.json`

**Test Scenario:**
```
User: /idumb:plan-phase 1

Expected Chain:
1. [COMMAND] plan-phase → idumb-supreme-coordinator
2. [DELEGATE] supreme → high-governance (with phase context)
3. [DELEGATE] high → low-validator (read phase prerequisites)
4. [RETURN] low-validator → high-governance (prerequisites status)
5. [DELEGATE] high → builder (if artifacts needed)
6. [RETURN] builder → high-governance (artifacts created)
7. [RETURN] high-governance → supreme (phase plan ready)
8. [RETURN] supreme → User (plan output)
```

**Validation Steps:**
1. Trace command entry point
2. Verify each delegation hop
3. Check permission enforcement at each level
4. Validate state mutations only by authorized agents
5. Confirm return path completeness

**Evidence Required:**
```
.idumb/governance/validations/e2e-chain-2026-02-03.json
```

**Evidence Schema:**
```json
{
  "validation_type": "e2e-chain",
  "timestamp": "ISO-8601",
  "test_command": "/idumb:plan-phase 1",
  "chain_trace": [
    {
      "step": 1,
      "from": "user",
      "to": "idumb-supreme-coordinator",
      "action": "command_invoke",
      "status": "success"
    }
  ],
  "total_hops": 8,
  "permission_violations": [],
  "state_mutations": [
    {
      "agent": "idumb-builder",
      "file": ".idumb/brain/state.json",
      "authorized": true
    }
  ],
  "overall_status": "PASS|FAIL",
  "blocking_issues": []
}
```

**Estimated Effort:** 45 minutes  
**Delegated To:** idumb-high-governance (orchestration), idumb-low-validator (tracing)
</task>

---

## Success Criteria

| Metric | Target |
|--------|--------|
| Agent validations passed | 10/10 |
| Command validations passed | 12/12 |
| E2E chain test passed | 1/1 |
| Permission violations | 0 |
| Blocking issues | 0 |

---

## Evidence Artifacts

Upon completion, the following files MUST exist:

```
.idumb/governance/validations/
├── agent-chain-2026-02-03.json
├── command-chain-2026-02-03.json
└── e2e-chain-2026-02-03.json
```

---

## Rollback Plan

If validation fails:
1. Identify failing component (agent/command/chain)
2. Reference original contract in 01-01, 01-02, or 01-03
3. Fix contract violation
4. Re-run validation
5. Document fix in `.idumb/brain/state.json` history

---

## Sign-off

- [ ] All tasks completed
- [ ] All evidence artifacts created
- [ ] No blocking issues
- [ ] Ready for Phase 02

**Completed By:** _pending_  
**Completion Date:** _pending_
