---
name: plan-template
id: tpl-plan
parent: templates
description: "Template for phase execution plans (PLAN.md)"
type: template
version: 0.1.0
output_pattern: ".planning/phases/{N}/{phase-name}-PLAN.md"
---

# Plan Template

Generates the PLAN.md document that defines executable tasks for a phase.

## Frontmatter Schema

```yaml
---
type: plan
phase: "{phase_number}"
phase_name: "{phase_name}"
status: "draft|checked|approved|executing|completed"
created: "{iso_timestamp}"
updated: "{iso_timestamp}"
created_by: "idumb-planner"
validated_by: "idumb-plan-checker"
validation_score: "{0-100}"
task_count: "{number}"
estimated_hours: "{number}"
---
```

## Document Structure

```markdown
# Phase {N}: {Phase Name} - Execution Plan

## Overview

**Goal:** {From CONTEXT.md}
**Approach:** {Strategy summary}
**Estimated Duration:** {hours/days}

## Tasks

### Task T{N}-001: {Task Title}

- **Description:** {What to do}
- **Acceptance Criteria:** 
  - [ ] {Criterion 1}
  - [ ] {Criterion 2}
- **Estimate:** {time}
- **Depends On:** {task IDs or "none"}
- **Assigned To:** {agent or "user"}
- **Files Involved:**
  - `{path/to/file1}`
  - `{path/to/file2}`

### Task T{N}-002: {Task Title}

{Same structure}

## Dependency Graph

```mermaid
graph TD
    T001[T{N}-001: Title] --> T002[T{N}-002: Title]
    T001 --> T003[T{N}-003: Title]
    T002 --> T004[T{N}-004: Title]
    T003 --> T004
```

## Execution Order

1. T{N}-001 - {Title} (no dependencies)
2. T{N}-002 - {Title} (after T001)
3. T{N}-003 - {Title} (after T001)
4. T{N}-004 - {Title} (after T002, T003)

## Risks and Mitigations

| Task | Risk | Mitigation |
|------|------|------------|
| T{N}-001 | {Risk} | {Mitigation} |

## Success Criteria

Inherited from CONTEXT.md:
- [ ] {Criterion 1}
- [ ] {Criterion 2}

Plan-specific:
- [ ] All tasks complete or intentionally skipped
- [ ] No blocking failures remain

## Validation Report

```yaml
validated_at: "{timestamp}"
validator: "idumb-plan-checker"
score: {0-100}
checks:
  - task_clarity: {pass|warn|fail}
  - dependency_valid: {pass|warn|fail}
  - estimates_reasonable: {pass|warn|fail}
  - criteria_measurable: {pass|warn|fail}
issues: []
```

---
*Generated by iDumb plan-template v0.1.0*
```

## Task Schema

```yaml
task_schema:
  id: "T{phase}-{seq:3}"  # e.g., T1-001
  required_fields:
    - title: string
    - description: string
    - acceptance_criteria: array<string>
    - estimate: duration
  optional_fields:
    - depends_on: array<task_id>
    - assigned_to: string
    - files_involved: array<path>
    - priority: "critical|high|normal|low"
    - blocked_by: string
```

## Generation Rules

```yaml
generation:
  required_sections:
    - overview
    - tasks (min 1)
    - execution_order
    - success_criteria
    
  validation:
    tasks:
      each_must_have:
        - description (min 10 chars)
        - acceptance_criteria (min 1)
        - estimate
    dependency_graph:
      must_be: "DAG (no cycles)"
    estimates:
      sum_should: "<= phase budget"
```

## Usage

```yaml
triggered_by:
  - "workflows/plan-phase.md step 3"
  - "idumb-planner agent output"
  
consumed_by:
  - "workflows/execute-phase.md step 1"
  - "idumb-builder agent"
```
